{% extends "dashboard/dashboard.html" %}

{% block link %}
{{ super() }}
<link rel="stylesheet" href="{{url_for('static', filename='css/policy.css')}}">
{% endblock link %}

{% block dashboard_content %}
<h2 class="mb-5">Register New Policy</h2>
<p style="padding-bottom: 20px">
  Only the admin is allowed to register for policy.
  <br />
</p>

{% if current_user.is_admin %}
            
<form class="register-form" smethod="POST" action="{{url_for('api.policy')}}">
  <div class="form-group">
    <label for="json-policydescription">Policy Description(JSON)</label>
    <pre id="json-policydescription"></pre>
  </div>
  <div class="form-group">
    <div class="custom-file">
      <input type="file" class="custom-file-input td-json" id="customFile">
      <label class="custom-file-label td-json" for="customFile">Choose file</label>
    </div>
  </div>
  <div class="form-group">
    <label for="targetLoc">Target Directory</label>
    <select type="text" name="targetLoc" id="targetLoc" class="form-control"
    value={{config['HOST_NAME']}}>
      <option value="level1">Level1</option>
      <option value="level2a">Level2a</option>
      <option value="level2b">Level2b</option>
      <option value="level3aa">Level3aa</option>
      <option value="level3ab">Level3ab</option>
      <option value="level4aba">Level4aba</option>
      <option value="level4abb">Level4abb</option>
      <option value="level5abba">Level5abba</option>
      <option value="level5abbb">Level5abbb</option>
    </select>
  </div>
  <div class="form-group">
    <button id="submit" type="button" class="btn btn-primary mt-3">Register</button>
  </div>
</form>
{% else %}
<p style="padding-bottom: 20px">
  As a user, you do not have access to registering for new policies. You can
  view the policies registered in the system.
</p>


<h3> Policies: </h3>
<table class="policy_table">
  <thead>
    <th>Policy UID</th>
    <th>Location</th>
    <th>Action</th>
  </thead>
  {% for p in policies %}
    <tr>
        <td class="uid"> {{ p['uid'] }} </td> 
        <td class="location"> {{ p['location'] }} </td> 
        <td><button type="button" class="btn btn-primary delete_policy">Delete</button></td>
    </tr>
  {% endfor %}
</table>

{% endif %}

{% endblock dashboard_content %}

{% block script %}
{{ super() }}
<script src="{{url_for('static', filename='js/policyjson.js')}}"> </script>
{% endblock script%}
